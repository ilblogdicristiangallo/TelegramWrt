#!/bin/sh
# Plugin /wifi_disable for TelegramWrt
# Disable the router's Wi-Fi interface, with existence check

LOG="/var/log/wifi_control.log"
TIME=$(date '+%Y-%m-%d %H:%M:%S')

# Check if wireless configuration exists
uci show wireless > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "[$TIME] ‚ùå Unable to disable Wi-Fi interface (not found)" >> "$LOG"
    echo "‚ùå Unable to disable Wi-Fi interface."
    exit 1
fi

echo "üîí Disabling Wi-Fi interface..."

wifi down

if [ $? -eq 0 ]; then
    echo "[$TIME] ‚úÖ Wi-Fi disabled successfully" >> "$LOG"
    echo "‚úÖ Wi-Fi disabled successfully."
else
    echo "[$TIME] ‚ö†Ô∏è Error disabling Wi-Fi" >> "$LOG"
    echo "‚ö†Ô∏è Error disabling Wi-Fi."
fi

exit 0

