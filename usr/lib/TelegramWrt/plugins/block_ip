#!/bin/sh

IP="$1"

if [ -z "$IP" ]; then
  echo "❌ Usage: /block_ip <IP_ADDRESS>"
  echo "Example: /block_ip 192.168.1.100"
  exit 1
fi

# Verifica formato IP
if ! echo "$IP" | grep -Eq '^([0-9]{1,3}\.){3}[0-9]{1,3}$'; then
  echo "❌ Invalid IP format: $IP"
  exit 1
fi

# Applica regola iptables
iptables -I INPUT -s "$IP" -j DROP

echo "✅ IP $IP has been blocked via firewall."
