#!/bin/sh
# Plugin /restart_wifi for TelegramWrt
# Restart the router's Wi-Fi interface, with existence check

LOG="/var/log/wifi_control.log"
TIME=$(date '+%Y-%m-%d %H:%M:%S')

# Check if wireless configuration exists
uci show wireless > /dev/null 2>&1
if [ $? -ne 0 ]; then
    echo "[$TIME] ‚ùå Unable to restart Wi-Fi interface (not found)" >> "$LOG"
    echo "‚ùå Unable to restart Wi-Fi interface."
    exit 1
fi

echo "üîÑ Restarting Wi-Fi interface..."

wifi

if [ $? -eq 0 ]; then
    echo "[$TIME] ‚úÖ Wi-Fi restarted successfully" >> "$LOG"
    echo "‚úÖ Wi-Fi restarted successfully."
else
    echo "[$TIME] ‚ö†Ô∏è Error restarting Wi-Fi" >> "$LOG"
    echo "‚ö†Ô∏è Error restarting Wi-Fi."
fi

exit 0

